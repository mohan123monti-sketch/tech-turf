<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tech Turf - Contact Us</title>

    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Our New Centralized Files -->
    <link rel="stylesheet" href="/src/css/pages/style.css">
    <script src="/src/js/core/layout.js" defer></script>
</head>
<!-- 
  data-page="Contact" tells layout.js which nav link to highlight.
  data-3d-enabled="true" tells layout.js to load the 3D background.
-->

<body data-page="Contact" data-3d-enabled="true">

    <!-- This div is the target for the Three.js canvas -->
    <div id="three-container"></div>

    <!-- This div will be filled by layout.js -->
    <div id="header-container"></div>

    <!-- Main Page Content -->
    <main class="relative z-10 py-24 sm:py-32 px-4">
        <div class="max-w-4xl mx-auto">

            <!-- Hero Section -->
            <div class="text-center mb-24">
                <h1
                    class="text-6xl md:text-9xl font-black text-white mb-6 uppercase tracking-tighter leading-none reveal-hidden">
                    Protocol<br><span class="text-white">Relay</span>
                </h1>
                <p class="text-[10px] font-black text-white/50 uppercase tracking-[0.3em] mt-8 opacity-50 reveal-hidden"
                    style="transition-delay: 0.2s;">
                    Direct Node Activation // Future Channel
                </p>
                <p class="text-xl md:text-2xl text-white/60 max-w-2xl mx-auto mt-12 font-medium leading-relaxed reveal-hidden"
                    style="transition-delay: 0.4s;">
                    Establish a high-fidelity communication link with our specialized divisions.
                </p>
            </div>

            <!-- Contact Form Section -->
            <section>
                <div class="iphone-glass p-12 md:p-20 reveal-hidden rounded-[4rem] border border-white/10 shadow-3xl">
                    <form id="contact-form" class="space-y-12">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                            <div>
                                <label for="first-name"
                                    class="block text-[10px] font-black text-white/30 mb-3 uppercase tracking-[0.2em]">First
                                    Identity</label>
                                <input type="text" id="first-name" name="first-name" required placeholder="GIVEN NAME"
                                    class="w-full bg-white/5 border border-white/10 rounded-[1.5rem] px-6 py-5 text-white outline-none focus:bg-white/10 focus:border-white/20 transition-all font-medium text-sm placeholder:text-white/10">
                            </div>
                            <div>
                                <label for="last-name"
                                    class="block text-[10px] font-black text-white/30 mb-3 uppercase tracking-[0.2em]">Last
                                    Identity</label>
                                <input type="text" id="last-name" name="last-name" required placeholder="FAMILY NAME"
                                    class="w-full bg-white/5 border border-white/10 rounded-[1.5rem] px-6 py-5 text-white outline-none focus:bg-white/10 focus:border-white/20 transition-all font-medium text-sm placeholder:text-white/10">
                            </div>
                        </div>

                        <div>
                            <label for="email"
                                class="block text-[10px] font-black text-white/30 mb-3 uppercase tracking-[0.2em]">Electronic
                                Mail</label>
                            <input type="email" id="email" name="email" required placeholder="relay@example.com"
                                class="w-full bg-white/5 border border-white/10 rounded-[1.5rem] px-6 py-5 text-white outline-none focus:bg-white/10 focus:border-white/20 transition-all font-medium text-sm placeholder:text-white/10">
                        </div>

                        <div>
                            <label for="subject"
                                class="block text-[10px] font-black text-white/30 mb-3 uppercase tracking-[0.2em]">Deployment
                                Subject</label>
                            <input type="text" id="subject" name="subject" required placeholder="NATURE OF INQUIRY"
                                class="w-full bg-white/5 border border-white/10 rounded-[1.5rem] px-6 py-5 text-white outline-none focus:bg-white/10 focus:border-white/20 transition-all font-medium text-sm placeholder:text-white/10">
                        </div>

                        <div>
                            <label for="message"
                                class="block text-[10px] font-black text-white/30 mb-3 uppercase tracking-[0.2em]">Transmission
                                Data</label>
                            <textarea id="message" name="message" rows="6" required
                                placeholder="ENTER MESSAGE CONTENT..."
                                class="w-full bg-white/5 border border-white/10 rounded-[2rem] px-6 py-6 text-white outline-none focus:bg-white/10 focus:border-white/20 transition-all font-medium text-sm resize-none placeholder:text-white/10"></textarea>
                        </div>

                        <div class="pt-8">
                            <button type="submit" id="submit-button"
                                class="magnetic-btn w-full bg-white text-black py-6 text-xs font-black uppercase tracking-[0.2em] rounded-[1.5rem] hover:bg-gray-200 transition-all shadow-2xl shadow-white/10 flex items-center justify-center gap-4">
                                Initiate Transmission
                                <i data-lucide="send" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </form>
                </div>
            </section>
        </div>
    </main>

    <!-- Confirmation Modal -->
    <div id="confirmation-modal"
        class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-2xl hidden p-4">
        <div
            class="iphone-glass max-w-md w-full p-16 rounded-[4rem] text-center border border-white/10 shadow-3xl transform transition-all scale-95 opacity-0">
            <div
                class="w-24 h-24 rounded-[2rem] iphone-glass flex items-center justify-center mb-12 border border-white/10 mx-auto shadow-2xl">
                <i data-lucide="check-circle" class="w-12 h-12 text-white"></i>
            </div>
            <h3 class="text-4xl font-black text-white mb-4 uppercase tracking-tighter leading-none">
                Transmission<br>Active</h3>
            <p class="text-gray-400 mb-12 text-sm font-medium leading-relaxed opacity-70">
                Your data packet has been successfully relayed to the division hub.
            </p>
            <button id="close-modal" type="button"
                class="w-full bg-white text-black py-5 text-xs font-black uppercase tracking-[0.2em] rounded-2xl hover:bg-gray-200 transition-all shadow-2xl shadow-white/10">
                Acknowledge
            </button>
        </div>
    </div>


    <!-- This div will be filled by layout.js -->
    <div id="footer-container"></div>

    <!-- 
      This is page-specific JavaScript for the contact form modal.
      NOW CONNECTED TO THE LIVE BACKEND.
    -->
    <script>
        window.addEventListener('load', () => {

            /**
             * Waits for layout.js to be ready
             */
            function checkLayoutReady() {
                if (typeof window.API_BASE_URL !== 'undefined' &&
                    typeof window.showMessage === 'function') {

                    console.log("layout.js loaded. Initializing contact form.");
                    initializeContactForm();

                } else {
                    console.warn("Waiting for layout.js to load...");
                    setTimeout(checkLayoutReady, 100);
                }
            }

            function initializeContactForm() {
                const form = document.getElementById('contact-form');
                const submitButton = document.getElementById('submit-button');
                const modal = document.getElementById('confirmation-modal');
                const modalContent = modal.querySelector('.iphone-glass');
                const closeModalBtn = document.getElementById('close-modal');

                form.addEventListener('submit', async function (e) {
                    e.preventDefault();

                    // Disable button
                    submitButton.disabled = true;
                    submitButton.innerHTML = '<i data-lucide="loader" class="animate-spin w-5 h-5 mx-auto"></i>';
                    lucide.createIcons();

                    // Collect form data
                    const formData = {
                        formType: 'contact',
                        firstName: document.getElementById('first-name').value,
                        lastName: document.getElementById('last-name').value,
                        email: document.getElementById('email').value,
                        subject: document.getElementById('subject').value,
                        message: document.getElementById('message').value
                    };

                    try {
                        // --- REAL API CALL ---
                        const response = await fetch(`${window.API_BASE_URL}/forms/submit`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                                // We can add auth token here if user is logged in
                            },
                            body: JSON.stringify(formData)
                        });

                        const data = await response.json();

                        if (response.ok) {
                            // --- SUCCESS ---
                            // Show the modal with animation
                            modal.classList.remove('hidden');
                            setTimeout(() => {
                                modalContent.style.transform = 'scale(1)';
                                modalContent.style.opacity = '1';
                            }, 10);

                            e.target.reset(); // Clear the form
                        } else {
                            throw new Error(data.message || 'Failed to submit form');
                        }

                    } catch (err) {
                        console.error('Form submission error:', err);
                        window.showMessage('error', err.message);
                    } finally {
                        // Re-enable button
                        submitButton.disabled = false;
                        submitButton.innerHTML = 'Initiate Transmission <i data-lucide="send" class="w-4 h-4"></i>';
                        lucide.createIcons();
                    }
                });

                function closeModal() {
                    const mc = modal.querySelector('.iphone-glass');
                    mc.style.transform = 'scale(0.95)';
                    mc.style.opacity = '0';
                    setTimeout(() => {
                        modal.classList.add('hidden');
                    }, 300);
                }

                closeModalBtn.addEventListener('click', closeModal);
                modal.addEventListener('click', function (e) {
                    if (e.target === modal) {
                        closeModal();
                    }
                });
            }

            // --- Start the Check ---
            checkLayoutReady();
        });
    </script>
</body>

</html>