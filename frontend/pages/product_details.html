<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tech Turf - Product Specifications</title>

    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Styles & Scripts -->
    <link rel="stylesheet" href="/src/css/pages/style.css">
    <link rel="stylesheet" href="/src/css/pages/shop-styles.css">
    <script src="/src/js/core/layout.js" defer></script>
</head>

<body data-page="Shop" class="shop-branding">

    <!-- Header -->
    <div id="header-container"></div>

    <main class="relative z-10 py-32 px-4 min-h-screen">
        <div class="shop-container">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-start">

                <!-- ðŸ§Š Product Image Gallery -->
                <div class="sticky top-32">
                    <div
                        class="featured-card bg-white/5 border border-white/10 p-4 rounded-[40px] shadow-2xl overflow-hidden aspect-square">
                        <img id="product-image" src="https://placehold.co/800x800" alt="Product"
                            class="w-full h-full object-cover rounded-[30px] transition-transform duration-1000 hover:scale-105">
                    </div>
                </div>

                <!-- ðŸ“ Product Information -->
                <div class="py-6 space-y-10">
                    <div class="space-y-4">
                        <span id="product-category"
                            class="text-[#d2670e] font-black text-xs uppercase tracking-[0.4em]">Hardware Node</span>
                        <h1 id="product-name"
                            class="text-6xl md:text-7xl font-black uppercase text-white tracking-tighter leading-none">
                            Scanning...</h1>
                    </div>

                    <div class="flex items-center gap-8">
                        <span id="product-price" class="text-5xl font-black text-white">â‚¹0.00</span>
                        <div id="stock-status"
                            class="flex items-center gap-2 px-4 py-2 bg-green-500/10 border border-green-500/20 rounded-full text-green-500 text-[10px] font-bold uppercase tracking-widest">
                            <div class="w-2 h-2 bg-green-500 rounded-full shadow-[0_0_8px_#22c55e]"></div>
                            <span id="stock-text">In Stock</span>
                        </div>
                    </div>

                    <p id="product-desc" class="text-gray-400 text-lg leading-relaxed max-w-xl">
                        Acquiring secure data link to product specifications...
                    </p>

                    <!-- ðŸ“Š Specifications Table -->
                    <div class="iphone-glass p-8 rounded-[30px] border border-white/5 space-y-6">
                        <h3
                            class="text-white font-black text-xs uppercase tracking-widest border-b border-white/5 pb-4">
                            Technical Manifest</h3>
                        <div id="specifications-grid" class="space-y-4">
                            <!-- Injected via JS -->
                            <div class="flex justify-between items-center py-2 border-b border-white/5">
                                <span class="text-gray-500 text-[10px] uppercase font-bold tracking-widest">Model
                                    Status</span>
                                <span class="text-white font-medium text-sm">Verified</span>
                            </div>
                        </div>
                    </div>

                    <!-- ðŸ›’ Actions -->
                    <div class="flex flex-col sm:flex-row gap-6 pt-10">
                        <button id="add-to-cart-btn" class="cta-btn magnetic-btn flex-1 justify-center">
                            <i data-lucide="shopping-cart" class="w-5 h-5"></i>
                            Add to Cart
                        </button>
                        <a href="shopping.html"
                            class="px-12 py-6 bg-white/5 border border-white/10 rounded-2xl text-white font-black text-xs uppercase tracking-widest hover:bg-white/10 transition-all flex items-center justify-center">
                            Return to Grid
                        </a>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <div id="footer-container"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('id');

            async function loadProduct() {
                if (typeof window.API_BASE_URL === 'undefined') {
                    setTimeout(loadProduct, 100);
                    return;
                }

                if (!productId) {
                    document.getElementById('product-name').textContent = 'Node Unknown';
                    return;
                }

                try {
                    const response = await fetch(`${window.API_BASE_URL}/products/${productId}`);
                    const product = await response.json();

                    document.getElementById('product-name').textContent = product.name;
                    document.getElementById('product-desc').textContent = product.description;
                    document.getElementById('product-price').textContent = `â‚¹${product.price}`;
                    document.getElementById('product-category').textContent = product.branch || 'Corporate Tech';

                    const stockCount = Number(product.stock || product.countInStock || 0);
                    const stockStatus = document.getElementById('stock-status');
                    const stockText = document.getElementById('stock-text');
                    const stockDot = stockStatus.querySelector('div');

                    if (stockCount > 0) {
                        stockText.textContent = `In Stock (${stockCount})`;
                        stockStatus.classList.remove('bg-red-500/10', 'border-red-500/20', 'text-red-500');
                        stockStatus.classList.add('bg-green-500/10', 'border-green-500/20', 'text-green-500');
                        stockDot.classList.remove('bg-red-500', 'shadow-[0_0_8px_#ef4444]');
                        stockDot.classList.add('bg-green-500', 'shadow-[0_0_8px_#22c55e]');
                    } else {
                        stockText.textContent = 'Out of Stock';
                        stockStatus.classList.remove('bg-green-500/10', 'border-green-500/20', 'text-green-500');
                        stockStatus.classList.add('bg-red-500/10', 'border-red-500/20', 'text-red-500');
                        stockDot.classList.remove('bg-green-500', 'shadow-[0_0_8px_#22c55e]');
                        stockDot.classList.add('bg-red-500', 'shadow-[0_0_8px_#ef4444]');
                    }

                    if (product.imageUrl) {
                        document.getElementById('product-image').src = product.imageUrl;
                    }

                    // Render Specs
                    const specGrid = document.getElementById('specifications-grid');
                    if (product.specifications && Object.keys(product.specifications).length > 0) {
                        specGrid.innerHTML = '';
                        for (const [key, value] of Object.entries(product.specifications)) {
                            const div = document.createElement('div');
                            div.className = 'flex justify-between items-center py-2 border-b border-white/5';
                            div.innerHTML = `
                                <span class="text-gray-500 text-[10px] uppercase font-bold tracking-widest">${key}</span>
                                <span class="text-white font-medium text-sm">${value}</span>
                            `;
                            specGrid.appendChild(div);
                        }
                    }

                    // Add to Cart
                    const addToCartBtn = document.getElementById('add-to-cart-btn');
                    if (stockCount > 0) {
                        addToCartBtn.disabled = false;
                        addToCartBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                        addToCartBtn.textContent = 'Add to Cart';
                        addToCartBtn.addEventListener('click', () => {
                            window.addToCart({
                                name: product.name,
                                price: product.price,
                                imageUrl: product.imageUrl,
                                id: product._id,
                                branch: product.branch || product.category || 'Tech Turf'
                            });
                        });
                    } else {
                        addToCartBtn.disabled = true;
                        addToCartBtn.classList.add('opacity-50', 'cursor-not-allowed');
                        addToCartBtn.textContent = 'Out of Stock';
                    }

                    if (window.lucide) lucide.createIcons();

                } catch (err) {
                    console.error(err);
                    document.getElementById('product-name').textContent = 'System Error';
                }
            }

            loadProduct();
        });
    </script>
</body>

</html>